<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="color-scheme" content="dark light" />
  <title>Outernet Planetary Time Command</title>
  <style>
    :root{
      --bg:#070a10; --panel:#0c1220; --line:rgba(255,255,255,.10);
      --text:#e9eef7; --muted:rgba(233,238,247,.72); --soft:rgba(233,238,247,.10);
      --ok:rgba(0,255,136,.85); --warn:rgba(255,209,102,.9);
      --radius:16px;
      font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,sans-serif;
    }
    body{ margin:0; background:radial-gradient(1200px 900px at 20% 10%, #0c1730, var(--bg)); color:var(--text); }
    header{ padding:18px 16px 8px; }
    h1{ margin:0; font-size:1.22rem; letter-spacing:.2px; }
    .sub{ margin-top:8px; color:var(--muted); line-height:1.35; font-size:.98rem; }
    main{ padding:12px 16px 24px; display:grid; gap:12px; max-width:980px; margin:0 auto; }
    .panel{ background:linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.03));
      border:1px solid var(--line); border-radius:var(--radius); padding:14px; }
    .row{ display:flex; gap:10px; align-items:center; justify-content:space-between; flex-wrap:wrap; }
    .tag{ display:inline-flex; align-items:center; gap:8px; padding:8px 10px; border:1px solid var(--line);
      background:rgba(0,0,0,.18); border-radius:999px; color:var(--muted); font-size:.92rem; }
    .grid{ display:grid; gap:10px; grid-template-columns:1fr; }
    @media (min-width:820px){ .grid.two{ grid-template-columns:1.1fr .9fr; } }
    label span{ display:block; margin-bottom:6px; color:var(--muted); font-size:.92rem; }
    input{ width:100%; padding:12px; border-radius:14px; border:1px solid var(--line);
      background:rgba(0,0,0,.22); color:var(--text); font-size:1rem; }
    button{ width:100%; padding:12px 14px; border-radius:14px; border:1px solid var(--line);
      background:rgba(255,255,255,.06); color:var(--text); font-size:1rem; }
    button:active{ transform:translateY(1px); }
    .muted{ color:var(--muted); }
    .small{ font-size:.92rem; }
    .table{ margin-top:10px; border-top:1px solid var(--line); }
    .trow{ display:grid; grid-template-columns: 1fr auto; gap:12px; padding:10px 0; border-bottom:1px solid rgba(255,255,255,.06); }
    .trow strong{ font-variant-numeric:tabular-nums; }
    .pill{ display:inline-flex; padding:6px 10px; border-radius:999px; border:1px solid var(--line); background:rgba(0,0,0,.18); }
    a{ color:inherit; text-decoration:none; }
    .btnRow{ display:grid; gap:10px; grid-template-columns:1fr; margin-top:10px; }
    @media (min-width:820px){ .btnRow{ grid-template-columns:repeat(3,1fr);} }
    .linkBtn{ display:block; padding:12px; border-radius:14px; border:1px solid var(--line); background:rgba(0,0,0,.18); }
    .linkBtn .top{ display:flex; justify-content:space-between; gap:8px; align-items:center; }
    .linkBtn .desc{ margin-top:6px; color:var(--muted); font-size:.92rem; line-height:1.35; }
    footer{ padding:10px 16px 22px; color:var(--muted); max-width:980px; margin:0 auto; }
    .ok{ color:var(--ok); }
    .warn{ color:var(--warn); }
  </style>
</head>

<body>
  <header>
    <h1>Outernet Planetary Time Command</h1>
    <div class="sub">
      A calm command-board showing how time behaves across the solar system.
      <span class="pill">No tracking</span> <span class="pill">UTC-anchored</span> <span class="pill">Physics-first</span>
    </div>
  </header>

  <main>
    <section class="panel">
      <div class="row">
        <div class="tag">üï∞Ô∏è Earth UTC (Zulu): <strong id="utcNow">‚Äî</strong></div>
        <div class="tag">üîÅ Snapshot refresh: <strong id="refreshRate">60</strong>s</div>
      </div>
      <p class="muted small" style="margin:10px 0 0;">
        This system records motion and reality. It does not ‚Äúinvent‚Äù hours where physics doesn‚Äôt support them.
      </p>
    </section>

    <section class="panel">
      <h2 style="margin:0 0 8px; font-size:1.05rem;">Planetary Age + Planet Birthdays</h2>
      <div class="grid two">
        <div>
          <label>
            <span>Birthdate (recommended)</span>
            <input id="birthdate" type="date" />
          </label>
          <p class="muted small" style="margin:8px 0 0;">
            We compute Earth age from your birthdate in UTC to avoid timezone edge cases.
          </p>
        </div>
        <div>
          <label>
            <span>OR Earth age (quick mode)</span>
            <input id="earthAge" inputmode="decimal" type="number" min="0" step="0.01" placeholder="e.g., 27.5" />
          </label>
          <button id="calc">Calculate</button>
          <p class="muted small" style="margin:8px 0 0;">
            Output includes: planetary age (in that planet‚Äôs years) + next ‚Äúplanet birthday‚Äù date (Earth UTC).
          </p>
        </div>
      </div>

      <div id="results" class="table" aria-live="polite"></div>
    </section>

    <section class="panel" id="keysPanel">
      <h2 style="margin:0 0 8px; font-size:1.05rem;">Three External Navigation Keys</h2>
      <p class="muted small" style="margin:0 0 10px;">
        FlightLine does not embed these systems. It routes to them cleanly to keep sovereignty and reduce dependency risk.
        <span id="keysStatus" class="pill">‚Äî</span>
      </p>

      <div class="btnRow" id="keysButtons" hidden>
        <a class="linkBtn" href="https://eyes.nasa.gov/" target="_blank" rel="noopener noreferrer">
          <div class="top"><strong>NASA Eyes</strong><span class="pill">Live navigation</span></div>
          <div class="desc">Orbital mechanics, planet positions, spacecraft context. Mission-grade reference.</div>
        </a>
        <a class="linkBtn" href="https://stellarium-web.org/" target="_blank" rel="noopener noreferrer">
          <div class="top"><strong>Stellarium Web</strong><span class="pill">Observation</span></div>
          <div class="desc">See planetary position from Earth‚Äôs sky. Visual grounding for the public.</div>
        </a>
        <a class="linkBtn" href="https://trek.nasa.gov/" target="_blank" rel="noopener noreferrer">
          <div class="top"><strong>NASA Trek</strong><span class="pill">Surface truth</span></div>
          <div class="desc">Planetary surface mapping portals. Closest public equivalent to ‚Äúmaps for worlds.‚Äù</div>
        </a>
      </div>

      <p class="muted small" style="margin:10px 0 0;">
        If you want these locked until a specific date, change the <code>KEYS_UNLOCK_UTC</code> constant in the script.
      </p>
    </section>
  </main>

  <footer class="small">
    <div>Outernet Doctrine: <span class="ok">Circulation is value.</span> If it doesn‚Äôt move, it doesn‚Äôt exist.</div>
    <div class="muted" style="margin-top:6px;">This page stores nothing. All calculations happen on your device.</div>
  </footer>

<script>
(() => {
  "use strict";

  // ======= CONFIG =======
  const SNAPSHOT_REFRESH_SECONDS = 60;

  // Unlock the external keys on Jan 1 (UTC). Change as needed.
  const KEYS_UNLOCK_UTC = Date.UTC(2026, 0, 1, 0, 0, 0); // 2026-01-01T00:00:00Z

  // Orbital periods in Earth years (approx; stable, widely used)
  const ORBITAL = [
    { name: "Mercury", years: 0.2408467 },
    { name: "Venus",   years: 0.61519726 },
    { name: "Earth",   years: 1.0 },
    { name: "Mars",    years: 1.8808158 },
    { name: "Jupiter", years: 11.862615 },
    { name: "Saturn",  years: 29.447498 },
    { name: "Uranus",  years: 84.016846 },
    { name: "Neptune", years: 164.79132 }
  ];

  // Use mean tropical year for Earth-year conversion
  const EARTH_YEAR_DAYS = 365.2425;
  const MS_PER_DAY = 86400000;

  // ======= UI HOOKS =======
  const utcNowEl = document.getElementById("utcNow");
  const refreshRateEl = document.getElementById("refreshRate");
  const birthEl = document.getElementById("birthdate");
  const ageEl = document.getElementById("earthAge");
  const btn = document.getElementById("calc");
  const resultsEl = document.getElementById("results");

  const keysStatusEl = document.getElementById("keysStatus");
  const keysButtonsEl = document.getElementById("keysButtons");

  refreshRateEl.textContent = String(SNAPSHOT_REFRESH_SECONDS);

  // ======= TIME DISPLAY =======
  function fmtUTC(ms){
    const d = new Date(ms);
    // Safari safe: toISOString exists, but keep readable:
    return d.toISOString().replace("T"," ").replace(".000Z","Z");
  }
  function tickUTC(){
    utcNowEl.textContent = fmtUTC(Date.now());
  }

  // ======= KEY UNLOCK =======
  function updateKeys(){
    const now = Date.now();
    if (now >= KEYS_UNLOCK_UTC){
      keysStatusEl.textContent = "UNLOCKED";
      keysButtonsEl.hidden = false;
    } else {
      keysStatusEl.textContent = "LOCKED UNTIL JAN 1 (UTC)";
      keysButtonsEl.hidden = true;
    }
  }

  // ======= AGE CALC =======
  function earthAgeFromBirthdate(dateStr){
    if (!dateStr) return null;
    const parts = dateStr.split("-").map(Number);
    if (parts.length !== 3) return null;
    const [y,m,d] = parts;
    if (!y || !m || !d) return null;
    const birthUTC = Date.UTC(y, m-1, d);
    const ms = Date.now() - birthUTC;
    if (ms < 0) return null;
    const days = ms / MS_PER_DAY;
    return days / EARTH_YEAR_DAYS;
  }

  function clampAge(n){
    return Number.isFinite(n) && n >= 0 ? n : null;
  }

  function fmtNum(n, decimals=2){
    if (!Number.isFinite(n)) return "‚Äî";
    return n.toFixed(decimals);
  }

  // Next whole-number planet "birthday":
  // Find next integer N > currentPlanetAge; solve for EarthAgeNeeded = N * orbitalYears
  // Convert EarthAgeNeeded into a date using birthdate (if provided); else show "requires birthdate".
  function nextPlanetBirthday(planetYears, earthAge, birthUTC){
    const current = earthAge / planetYears;
    const nextInt = Math.floor(current) + 1;
    const earthAgeNeeded = nextInt * planetYears;              // in Earth years
    const deltaYears = earthAgeNeeded - earthAge;              // Earth years from now
    const deltaDays = deltaYears * EARTH_YEAR_DAYS;
    const targetMs = Date.now() + (deltaDays * MS_PER_DAY);
    if (birthUTC == null) return { nextInt, dateStr: "Add birthdate for date" };
    // Better: compute from birthUTC (more stable):
    const targetFromBirth = birthUTC + (earthAgeNeeded * EARTH_YEAR_DAYS * MS_PER_DAY);
    return { nextInt, dateStr: fmtUTC(targetFromBirth) };
  }

  function render(earthAge, birthUTC){
    const rows = ORBITAL.map(p => {
      const pAge = earthAge / p.years;
      const next = nextPlanetBirthday(p.years, earthAge, birthUTC);
      return `
        <div class="trow">
          <div>
            <div><strong>${p.name}</strong> <span class="muted">(${fmtNum(p.years, 6)} Earth years / planet year)</span></div>
            <div class="muted small">Your age: <strong>${fmtNum(pAge, 2)}</strong> ${p.name} years</div>
            <div class="muted small">Next ${p.name} birthday: <strong>${next.nextInt}</strong> ${p.name} years ‚Üí <span class="pill">${next.dateStr}</span></div>
          </div>
          <div class="pill">${fmtNum((pAge % 1) * 100, 2)}% to next</div>
        </div>
      `;
    }).join("");

    resultsEl.innerHTML = `
      <div class="trow">
        <div>
          <div><strong>Earth age used:</strong> <span class="pill">${fmtNum(earthAge, 4)} years</span></div>
          <div class="muted small">Calculated locally. No data is saved.</div>
        </div>
        <div class="pill">UTC anchored</div>
      </div>
      ${rows}
    `;
  }

  btn.addEventListener("click", () => {
    const typed = clampAge(parseFloat(ageEl.value));
    const fromBirth = earthAgeFromBirthdate(birthEl.value);
    const earthAge = typed !== null ? typed : fromBirth;

    let birthUTC = null;
    if (birthEl.value){
      const [y,m,d] = birthEl.value.split("-").map(Number);
      if (y && m && d) birthUTC = Date.UTC(y, m-1, d);
    }

    if (earthAge === null){
      resultsEl.innerHTML = `<div class="trow"><div class="muted">Enter a valid birthdate or Earth age.</div><div class="pill warn">INPUT NEEDED</div></div>`;
      return;
    }
    render(earthAge, birthUTC);
  });

  // init
  tickUTC();
  updateKeys();
  setInterval(() => { tickUTC(); updateKeys(); }, SNAPSHOT_REFRESH_SECONDS * 1000);
})();
</script>
</body>
</html>
